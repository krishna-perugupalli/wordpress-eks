---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.1
  name: servicemonitors.monitoring.coreos.com
spec:
  group: monitoring.coreos.com
  names:
    kind: ServiceMonitor
    listKind: ServiceMonitorList
    plural: servicemonitors
    singular: servicemonitor
    shortNames:
      - sm
  scope: Namespaced
  versions:
    - name: v1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          description: ServiceMonitor defines monitoring for a set of services.
          properties:
            apiVersion:
              type: string
              description: 'APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            kind:
              type: string
              description: 'Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            metadata:
              type: object
            spec:
              type: object
              description: Specification of desired Service selection for target discovery by Prometheus.
              properties:
                attachMetadata:
                  description: Attaches node metadata to discovered targets.
                  type: object
                  properties:
                    node:
                      type: object
                      properties:
                        metadata:
                          description: |
                            Whether to attach all node metadata to discovered targets.
                            When not provided, defaults to attaching all metadata.
                          type: object
                          properties:
                            enabled:
                              type: boolean
                bearerTokenFile:
                  description: File to read bearer token for scraping targets.
                  type: string
                bearerTokenSecret:
                  description: Secret to mount to read bearer token for scraping targets. Deprecated: use 'authorization' configuration instead.
                  type: object
                  properties:
                    key:
                      type: string
                    name:
                      type: string
                    optional:
                      type: boolean
                endpoints:
                  description: A list of endpoints allowed as part of this ServiceMonitor.
                  type: array
                  minItems: 1
                  items:
                    type: object
                    properties:
                      authorization:
                        description: Authorization section for this endpoint
                        type: object
                        properties:
                          credentials:
                            description: |
                              The secret's key that contains the credentials of the request
                              The secret needs to be in the same namespace as the service monitor and accessible by the Prometheus Operator.
                            type: object
                            properties:
                              key:
                                type: string
                              name:
                                type: string
                              optional:
                                type: boolean
                          type:
                            description: Set the authentication type. Defaults to Bearer, basic will cause an error
                            type: string
                      basicAuth:
                        description: BasicAuth allow an endpoint to authenticate over basic authentication
                        type: object
                        properties:
                          password:
                            description: The secret in the service monitor namespace that contains the password for authentication.
                            type: object
                            properties:
                              key:
                                type: string
                              name:
                                type: string
                              optional:
                                type: boolean
                          username:
                            description: The secret in the service monitor namespace that contains the username for authentication.
                            type: object
                            properties:
                              key:
                                type: string
                              name:
                                type: string
                              optional:
                                type: boolean
                      bearerTokenFile:
                        description: File to read bearer token for scraping targets.
                        type: string
                      bearerTokenSecret:
                        description: Secret to mount to read bearer token for scraping targets. Deprecated: use 'authorization' configuration instead.
                        type: object
                        properties:
                          key:
                            type: string
                          name:
                            type: string
                          optional:
                            type: boolean
                      followRedirects:
                        description: FollowRedirects configures whether scrape requests follow HTTP 3xx redirects.
                        type: boolean
                      honorLabels:
                        description: HonorLabels chooses the metric's labels on collisions with target labels.
                        type: boolean
                      honorTimestamps:
                        description: HonorTimestamps controls whether Prometheus respects the timestamps present in scraped data.
                        type: boolean
                      interval:
                        description: Interval at which metrics should be scraped
                        type: string
                      metricRelabelings:
                        description: MetricRelabelConfigs to apply to samples before ingestion.
                        type: array
                        items:
                          type: object
                          properties:
                            action:
                              type: string
                            modulus:
                              type: integer
                              format: int64
                            regex:
                              type: string
                            replacement:
                              type: string
                            separator:
                              type: string
                            sourceLabels:
                              type: array
                              items:
                                type: string
                            targetLabel:
                              type: string
                        x-kubernetes-list-type: atomic
                      oauth2:
                        description: |
                          OAuth2 allows an endpoint to authenticate with OAuth2. More info: https://prometheus.io/docs/prometheus/latest/configuration/configuration/#oauth2
                        type: object
                        properties:
                          clientId:
                            description: The secret in the service monitor namespace that contains the client id
                            type: object
                            properties:
                              configMap:
                                description: ConfigMap containing data to use for the targets.
                                type: object
                                properties:
                                  key:
                                    description: The key to select.
                                    type: string
                                  name:
                                    description: Name of the referent.
                                    type: string
                                  optional:
                                    description: Specify whether the ConfigMap or its key must be defined
                                    type: boolean
                              secret:
                                description: Secret containing data to use for the targets.
                                type: object
                                properties:
                                  key:
                                    description: The key of the secret to select from. Must be a valid secret key.
                                    type: string
                                  name:
                                    description: Name of the referent.
                                    type: string
                                  optional:
                                    description: Specify whether the Secret or its key must be defined
                                    type: boolean
                          clientSecret:
                            description: The secret in the service monitor namespace that contains the client secret
                            type: object
                            properties:
                              key:
                                type: string
                              name:
                                type: string
                              optional:
                                type: boolean
                          endpointParams:
                            description: Parameters to append to the token URL
                            type: object
                            additionalProperties:
                              type: string
                          scopes:
                            description: OAuth2 scopes used for the token request
                            type: array
                            items:
                              type: string
                          tokenUrl:
                            description: |
                              The URL to fetch the token from
                            type: string
                          tlsConfig:
                            description: TLS configuration for the token request
                            type: object
                            properties:
                              ca:
                                description: Certificate authority used when verifying server certificates.
                                type: object
                                properties:
                                  configMap:
                                    description: ConfigMap containing data to use for the targets.
                                    type: object
                                    properties:
                                      key:
                                        description: The key to select.
                                        type: string
                                      name:
                                        description: Name of the referent.
                                        type: string
                                      optional:
                                        description: Specify whether the ConfigMap or its key must be defined
                                        type: boolean
                                  secret:
                                    description: Secret containing data to use for the targets.
                                    type: object
                                    properties:
                                      key:
                                        description: The key of the secret to select from. Must be a valid secret key.
                                        type: string
                                      name:
                                        description: Name of the referent.
                                        type: string
                                      optional:
                                        description: Specify whether the Secret or its key must be defined
                                        type: boolean
                              caFile:
                                description: Path to the CA cert in the Prometheus container to use for the targets.
                                type: string
                              cert:
                                description: |
                                  Client certificate to present when doing client-authentication.
                                  Must be provided with `keySecret`.
                                type: object
                                properties:
                                  configMap:
                                    description: ConfigMap containing data to use for the targets.
                                    type: object
                                    properties:
                                      key:
                                        description: The key to select.
                                        type: string
                                      name:
                                        description: Name of the referent.
                                        type: string
                                      optional:
                                        description: Specify whether the ConfigMap or its key must be defined
                                        type: boolean
                                  secret:
                                    description: Secret containing data to use for the targets.
                                    type: object
                                    properties:
                                      key:
                                        description: The key of the secret to select from. Must be a valid secret key.
                                        type: string
                                      name:
                                        description: Name of the referent.
                                        type: string
                                      optional:
                                        description: Specify whether the Secret or its key must be defined
                                        type: boolean
                              insecureSkipVerify:
                                description: Disable target certificate validation.
                                type: boolean
                              keyFile:
                                description: Path to the client key file in the Prometheus container for the targets.
                                type: string
                              serverName:
                                description: Used to verify the hostname for the targets.
                                type: string
                      params:
                        description: Optional HTTP URL parameters
                        type: object
                        additionalProperties:
                          type: array
                          items:
                            type: string
                      path:
                        description: HTTP path to scrape for metrics.
                        type: string
                      port:
                        description: Name of the service port this endpoint refers to.
                        type: string
                      proxyUrl:
                        description: HTTP proxy server to use to scrape.
                        type: string
                      relabelings:
                        description: RelabelConfigs to apply to samples before scraping.
                        type: array
                        items:
                          type: object
                          properties:
                            action:
                              type: string
                            modulus:
                              type: integer
                              format: int64
                            regex:
                              type: string
                            replacement:
                              type: string
                            separator:
                              type: string
                            sourceLabels:
                              type: array
                              items:
                                type: string
                            targetLabel:
                              type: string
                        x-kubernetes-list-type: atomic
                      scheme:
                        description: HTTP scheme to use for scraping.
                        type: string
                      scrapeTimeout:
                        description: Timeout after which the scrape is ended
                        type: string
                      targetPort:
                        description: Name or number of the pod port this endpoint refers to.
                        anyOf:
                          - type: string
                          - type: integer
                        x-kubernetes-int-or-string: true
                      tlsConfig:
                        description: TLS configuration to use when scraping the endpoint
                        type: object
                        properties:
                          ca:
                            description: Certificate authority used when verifying server certificates.
                            type: object
                            properties:
                              configMap:
                                description: ConfigMap containing data to use for the targets.
                                type: object
                                properties:
                                  key:
                                    description: The key to select.
                                    type: string
                                  name:
                                    description: Name of the referent.
                                    type: string
                                  optional:
                                    description: Specify whether the ConfigMap or its key must be defined
                                    type: boolean
                              secret:
                                description: Secret containing data to use for the targets.
                                type: object
                                properties:
                                  key:
                                    description: The key of the secret to select from. Must be a valid secret key.
                                    type: string
                                  name:
                                    description: Name of the referent.
                                    type: string
                                  optional:
                                    description: Specify whether the Secret or its key must be defined
                                    type: boolean
                          caFile:
                            description: Path to the CA cert in the Prometheus container to use for the targets.
                            type: string
                          cert:
                            description: |
                              Client certificate to present when doing client-authentication.
                              Must be provided with `keySecret`.
                            type: object
                            properties:
                              configMap:
                                description: ConfigMap containing data to use for the targets.
                                type: object
                                properties:
                                  key:
                                    description: The key to select.
                                    type: string
                                  name:
                                    description: Name of the referent.
                                    type: string
                                  optional:
                                    description: Specify whether the ConfigMap or its key must be defined
                                    type: boolean
                              secret:
                                description: Secret containing data to use for the targets.
                                type: object
                                properties:
                                  key:
                                    description: The key of the secret to select from. Must be a valid secret key.
                                    type: string
                                  name:
                                    description: Name of the referent.
                                    type: string
                                  optional:
                                    description: Specify whether the Secret or its key must be defined
                                    type: boolean
                          insecureSkipVerify:
                            description: Disable target certificate validation.
                            type: boolean
                          keyFile:
                            description: Path to the client key file in the Prometheus container for the targets.
                            type: string
                          serverName:
                            description: Used to verify the hostname for the targets.
                            type: string
                    required:
                      - port
                jobLabel:
                  description: The label to use to retrieve the job name from.
                  type: string
                namespaceSelector:
                  description: Selector to select which namespaces the Kubernetes Endpoints objects are discovered from.
                  type: object
                  properties:
                    any:
                      description: Boolean describing whether all namespaces are selected in contrast to a list restricting them.
                      type: boolean
                    matchExpressions:
                      description: List of label selector requirements that will be used to select namespaces.
                      type: array
                      items:
                        type: object
                        properties:
                          key:
                            type: string
                          operator:
                            type: string
                          values:
                            type: array
                            items:
                              type: string
                    matchNames:
                      description: List of namespace names to select from.
                      type: array
                      items:
                        type: string
                podTargetLabels:
                  description: PodTargetLabels transfers labels on the Kubernetes Pod onto the target.
                  type: array
                  items:
                    type: string
                sampleLimit:
                  description: SampleLimit defines per-scrape limit on number of scraped samples that will be accepted.
                  type: integer
                  format: int64
                selector:
                  description: Selector to select Endpoints objects.
                  type: object
                  properties:
                    matchExpressions:
                      description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                      type: array
                      items:
                        type: object
                        properties:
                          key:
                            type: string
                          operator:
                            type: string
                          values:
                            type: array
                            items:
                              type: string
                    matchLabels:
                      description: matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is "key", the operator is "In", and the values array contains only "value".
                      type: object
                      additionalProperties:
                        type: string
                targetLabels:
                  description: TargetLabels transfers labels from the Kubernetes Service onto the target.
                  type: array
                  items:
                    type: string
                targetLimit:
                  description: TargetLimit defines a limit on the number of scraped targets that will be accepted.
                  type: integer
                  format: int64
                tlsConfig:
                  description: TLS configuration to use when scraping the endpoint
                  type: object
                  properties:
                    ca:
                      description: Certificate authority used when verifying server certificates.
                      type: object
                      properties:
                        configMap:
                          description: ConfigMap containing data to use for the targets.
                          type: object
                          properties:
                            key:
                              description: The key to select.
                              type: string
                            name:
                              description: Name of the referent.
                              type: string
                            optional:
                              description: Specify whether the ConfigMap or its key must be defined
                              type: boolean
                        secret:
                          description: Secret containing data to use for the targets.
                          type: object
                          properties:
                            key:
                              description: The key of the secret to select from. Must be a valid secret key.
                              type: string
                            name:
                              description: Name of the referent.
                              type: string
                            optional:
                              description: Specify whether the Secret or its key must be defined
                              type: boolean
                    caFile:
                      description: Path to the CA cert in the Prometheus container to use for the targets.
                      type: string
                    cert:
                      description: |
                        Client certificate to present when doing client-authentication.
                        Must be provided with `keySecret`.
                      type: object
                      properties:
                        configMap:
                          description: ConfigMap containing data to use for the targets.
                          type: object
                          properties:
                            key:
                              description: The key to select.
                              type: string
                            name:
                              description: Name of the referent.
                              type: string
                            optional:
                              description: Specify whether the ConfigMap or its key must be defined
                              type: boolean
                        secret:
                          description: Secret containing data to use for the targets.
                          type: object
                          properties:
                            key:
                              description: The key of the secret to select from. Must be a valid secret key.
                              type: string
                            name:
                              description: Name of the referent.
                              type: string
                            optional:
                              description: Specify whether the Secret or its key must be defined
                              type: boolean
                    insecureSkipVerify:
                      description: Disable target certificate validation.
                      type: boolean
                    keyFile:
                      description: Path to the client key file in the Prometheus container for the targets.
                      type: string
                    serverName:
                      description: Used to verify the hostname for the targets.
                      type: string
              required:
                - endpoints
                - selector
      subresources:
        status: {}
