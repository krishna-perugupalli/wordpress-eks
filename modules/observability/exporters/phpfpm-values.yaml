# PHP-FPM Exporter Helm Values
#
# Purpose: Export PHP-FPM process manager metrics to Prometheus
# Phase: Phase 3 - To be implemented
#
# This exporter will scrape PHP-FPM status endpoint to collect metrics about
# worker processes, queue depth, slow requests, and resource utilization.
#
# Requirements: 5.5, 6.2
#
# TODO Phase 3:
# - Deploy as sidecar container in WordPress pods
# - Configure PHP-FPM status endpoint (pm.status_path = /status)
# - Set up ServiceMonitor to scrape metrics
# - Define alerting rules for worker saturation
# - Add resource requests/limits

# Example structure (commented out for Phase 1):
#
# image:
#   repository: hipages/php-fpm_exporter
#   tag: 2.2.0
#   pullPolicy: IfNotPresent
#
# # Deploy as sidecar in WordPress deployment
# deployment:
#   enabled: false  # Managed by WordPress module
#
# # Configuration for standalone deployment (if needed)
# config:
#   phpfpm:
#     # Scrape PHP-FPM status from localhost (sidecar pattern)
#     scrapeUri: "tcp://127.0.0.1:9000/status"
#     # Alternative for unix socket:
#     # scrapeUri: "unix:///var/run/php-fpm.sock;/status"
#     fixProcessCount: true
#
# service:
#   type: ClusterIP
#   port: 9253
#   annotations:
#     prometheus.io/scrape: "true"
#     prometheus.io/port: "9253"
#
# serviceMonitor:
#   enabled: true
#   interval: 30s
#   scrapeTimeout: 10s
#   labels:
#     release: kube-prometheus-stack
#
# # Key metrics exposed:
# # - phpfpm_up: FPM process is running
# # - phpfpm_accepted_connections_total: Total accepted connections
# # - phpfpm_active_processes: Number of active processes
# # - phpfpm_idle_processes: Number of idle processes
# # - phpfpm_max_active_processes: Maximum active processes reached
# # - phpfpm_max_children_reached_total: Times max children limit was reached
# # - phpfpm_slow_requests_total: Number of slow requests
# # - phpfpm_listen_queue: Current listen queue length
# # - phpfpm_listen_queue_length: Maximum listen queue length
#
# resources:
#   limits:
#     memory: 64Mi
#     cpu: 50m
#   requests:
#     memory: 32Mi
#     cpu: 10m
#
# # Alerting thresholds (to be defined in PrometheusRules)
# # - Worker saturation: active_processes / max_children > 0.8
# # - Queue buildup: listen_queue > 0
# # - Slow requests: slow_requests_total rate increasing
# # - Max children reached: max_children_reached_total increasing
